/*!
 *  Double Carousel Plugin for JQuery
 *  Version   : 0.9
 *  Date      : 2014-01-02
 *  Licence   : All rights reserved 
 *  Author    : owwwlab (Ehsan Dalvand & Alireza Jahandideh)
 *  Contact   : owwwlab@gmail.com
 *  Web site  : http://themeforest.net/user/owwwlab
 *  Dependencies: tweenmx, imagesLoaded
 */

if(typeof Object.create!=="function"){Object.create=function(e){function t(){}t.prototype=e;return new t}}(function(e,t,n,r){var i,s=false;var o={init:function(t,n){var r=this;r.elem=n;r.$elem=e(n);r.options=e.extend({},e.fn.DoubleCarousel.options,t);i=r.options;i.contentItems=i.contentSide.find(".item");i.imageItems=i.imageSide.find(".item");r.prepare();r.bindUIActions();i.imageWrapper.children().each(function(e,t){i.imageWrapper.prepend(t)})},handleBgColors:function(){function s(e,t){return parseInt(Math.random()*(t-e+1),10)+e}var t=i.contentWrapper.css("backgroundColor");var n=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);if(n){delete n[0];var r=this.rgbToHsv(n[1],n[2],n[3])}else{var r=[0,0,0]}i.items.each(function(){var t="hsl("+r[0]+","+r[1]+"%,"+s(r[2]-10,r[2]+10)+"%)";e(this).css("background",t)})},rgbToHsv:function(e,t,n){e/=255,t/=255,n/=255;var r=Math.max(e,t,n),i=Math.min(e,t,n);var s,o,u=(r+i)/2;if(r==i){s=o=0}else{var a=r-i;o=u>.5?a/(2-r-i):a/(r+i);switch(r){case e:s=(t-n)/a+(t<n?6:0);break;case t:s=(n-e)/a+2;break;case n:s=(e-t)/a+4;break}s/=6}return[Math.floor(s*360),Math.floor(o*100),Math.floor(u*100)]},prepare:function(){this.fillImages(i.imageItems);i.imageHeight=i.imageSide.height();i.desHeight=i.contentSide.children(".item").first().outerHeight();i.contentSide.find(".item-wrapper").each(function(){var t=e(this).outerHeight()/-2;e(this).css("margin-top",t)});i.slideCount=i.imageWrapper.find(".item").length;i.currentSlideIndex=0;i.counterTotal.html(i.slideCount);i.counterCurrent.html(1);i.nextButton.fadeIn();i.prevButton.fadeOut();i.initMargin=i.imageHeight*(i.slideCount-1);i.imageWrapper.css("margin-top",-i.initMargin);i.contentSide.css("margin-top",0)},nextSlide:function(){s=true;i.currentSlideIndex++;this.updateCounter(i.currentSlideIndex);if(i.currentSlideIndex+1==i.slideCount)i.nextButton.fadeOut();i.prevButton.fadeIn();(new TimelineLite({onComplete:function(){s=false}})).to(i.imageWrapper,1,{marginTop:"+="+i.imageHeight,ease:Power4.easeOut}).to(i.contentSide,.8,{marginTop:"-="+i.desHeight,ease:Power4.easeOut},"-=1")},prevSlide:function(){s=true;i.currentSlideIndex--;this.updateCounter(i.currentSlideIndex);if(i.currentSlideIndex==0){i.prevButton.fadeOut()}i.nextButton.fadeIn();(new TimelineLite({onComplete:function(){s=false}})).to(i.imageWrapper,1,{marginTop:"-="+i.imageHeight,ease:Power4.easeOut}).to(i.contentSide,.8,{marginTop:"+="+i.desHeight,ease:Power4.easeOut},"-=1")},updateCounter:function(e){i.counterCurrent.html(e+1)},bindUIActions:function(){self=this;i.nextButton.on("click",function(){if(s){return false}self.nextSlide()});i.prevButton.on("click",function(){if(s){return false}self.prevSlide()});e(t).on("debouncedresize",function(){self.prepare()})},fillImages:function(n){function r(){n.imagesLoaded(function(){var t=n.width(),r=n.height(),i=t/r,s;n.find("img").each(function(){var n=e(this);s=n.width()/n.height();if(i<s){n.css({width:"auto",height:r,top:0,left:-(r*s-t)/2})}else{n.css({width:t,height:"auto",top:-(t/s-r)/2,left:0})}})})}r();e(t).on("resized",function(){r()})}};e.fn.DoubleCarousel=function(e){return this.each(function(){var t=Object.create(o);t.init(e,this)})};e.fn.DoubleCarousel.options={imageWrapper:e(".image-side-wrapper"),contentWrapper:e(".content-carousel-wrapper"),contentSide:e(".content-carousel"),imageSide:e(".image-side"),nextButton:e(".vcarousel-next"),prevButton:e(".vcarousel-prev"),counterTotal:e(".vcarousel-counter .counter-total"),counterCurrent:e(".vcarousel-counter .counter-current")}})(jQuery,window,document)